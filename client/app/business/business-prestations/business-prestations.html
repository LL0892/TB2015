<div ng-include="'components/navbar/navbar.html'"></div>

<div class=container>
	<div class="row hidden-xs" ng-show="addForm === true">
		<div class="col-sm-12">
			<h3>Ajout d'une prestation</h3>
			<hr>
		</div>
		<div class="col-sm-6 col-sm-offset-3">
			<form class="form" name="form">

		        <!-- name -->
		        <div class="form-group" ng-class="{ 'has-success': form.name.$valid && submitted,
		                                            'has-error': form.name.$invalid && submitted }">
		          <label>Nom</label>

		          <input type="text" name="name" class="form-control" ng-model="prestation.name" placeholder="p. ex. coupe de cheveux" required/>
		          <p class="help-block" ng-show="form.name.$error.required && submitted">
		            Un nom est requis.
		          </p>
		        </div>

		        <!-- Description -->
		        <div class="form-group" ng-class="{ 'has-success': form.description.$valid && submitted,
		                                            'has-error': form.description.$invalid && submitted }">
		          <label>Description</label>

		          <textarea name="description" class="form-control" ng-model="prestation.description" ng-minlength="1" ng-maxlength="200" placeholder="une description de moins de 200 charactères"  required/>
		          <p class="help-block" ng-show="form.description.$error.required && submitted">
		            Une description est requise.
		          </p>
			      <p class="help-block" ng-show="form.description.$error.maxlength">Trop long! 200 charactères maximum.</p>
		        </div>

		        <!-- duration -->
				<div class="form-group">
				  <label for="duration">Durée (minutes) :</label>
				  <select class="form-control" id="duration" ng-model="prestation.duration" required>
				    <option value="5" selected>5</option>
				    <option value="10">10</option>
				    <option value="15">15</option>
				    <option value="20">20</option>
				    <option value="25">25</option>
				    <option value="30">30</option>
			    	<option value="35">35</option>
				    <option value="40">40</option>
				    <option value="45">45</option>
				    <option value="50">50</option>
				    <option value="55">55</option>
				    <option value="60">60</option>
				    <option value="65">65</option>
				    <option value="70">70</option>
				    <option value="75">75</option>
				    <option value="80">80</option>
				    <option value="85">85</option>
				    <option value="90">90</option>
			    	<option value="95">95</option>
				    <option value="100">100</option>
				    <option value="105">105</option>
				    <option value="110">110</option>
				    <option value="115">115</option>
				    <option value="120">120</option>
				  </select>
				</div>

        	<!-- Buttons -->
	        <div class="button-margins">
	          <button class="btn btn-success" type="submit" ng-click="addPrestation(form)">
	           	Envoyer
	          </button>
	          <button class="btn btn-danger" ng-click="cancelAddForm(form)">
	           	Annuler
	          </button>
	        </div>

			</form>
		</div>
	</div>

	<div class="row hidden-xs">
		<button class="btn btn-success" ng-click="addForm = true" ng-show="addForm === false"><i class="fa icon-tab fa-plus"></i> Ajouter une prestation</button>
	</div>



	<div class="row" ng-repeat="prestation in prestations">

		<div class="row">
			<div class="col-sm-12">
				<h3>{{prestation.name}}</h3>
				<button class="btn btn-primary btn-xs">Modifier</button>
				<button class="btn btn-danger btn-xs" ng-click="deletePrestation(prestation, $index)">Supprimer</button>
				<hr>
			</div>
		</div>

		<div class="row">
			<div class="col-sm-5 hr-right">
				<h4>Description</h4>
				<p>{{prestation.description}}</p>
				<hr>
				<h4>Durée</h4>
				<p>{{prestation.duration}} minutes</p>
			</div>
			<div class="col-sm-7">
				<table class="table">
					<thead>
						<tr>
							<th>Categorie</th>
							<th>Sexe </th>
							<th>Age min</th>
							<th>Age max</th>
							<th>Prix</th>
							<th class="hidden-xs">Actions</th>
						</tr>
						</thead>
						<tbody>

						
						<tr ng-repeat="price in prestation.prices">
							<!-- liste affichage -->
							<td ng-show="editPrice === false">{{price.categoryName}}</td>
							<td ng-show="editPrice === false">{{price.gender}}</td>
							<td ng-show="editPrice === false">{{price.ageLowLimit}}</td>
							<td ng-show="editPrice === false">{{price.ageHighLimit}}</td>
							<td ng-show="editPrice === false">{{price.price}}</td>

							<!-- formulaire modif -->
							<td ng-show="editPrice === true">
								<input class="input-form-big" type="text" ng-model="form.categoryName" ng-maxlength="20" />
							</td>
							<td ng-show="editPrice === true">
								<select  class="input-form-select" ng-model="form.gender" required>
									<option value="mixte" selected>mixte</option>
								    <option value="homme">homme</option>
								    <option value="femme">femme</option>
								 </select>
							</td>
							<td ng-show="editPrice === true">
								<input class="input-form-small" type="number" ng-model="form.ageLowLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1"/>
							</td>
							<td ng-show="editPrice === true">
								<input class="input-form-small" type="number" ng-model="form.ageHighLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1" />
							</td>
							<td ng-show="editPrice === true">
								<input class="input-form-med" type="number" ng-model="form.price"  min="1" max="999" ngMaxlength="3" ngMinlength="1" />
							</td>


							<td class="hidden-xs">
								<!-- bouton update -->
								<a href="#" class="btn btn-success label" ng-click="editPrice = false" ng-show="editPrice === true"><i class="fa icon-tab fa-check"></i></a>
								<div class="btn btn-danger label" ng-click="editPrice = false" ng-show="editPrice === true"><i class="fa icon-tab fa-close"></i></div>

								<!-- bouton visu -->
								<a href="#" class="btn btn-primary label" ng-click="editPrice = true" ng-show="editPrice === false"><i class="fa icon-tab fa-pencil-square-o"></i></a>
								<div class="btn btn-danger label" ng-click="deletePrice(prestation._id, price._id)" ng-show="editPrice === false"><i class="fa icon-tab fa-trash-o"></i></div>
							</td>
						</tr>


						<!-- Formulaire d'ajout -->
						<tr ng-show="hiddenForm === false">
							<td>
								<input class="input-form-big" type="text" ng-model="form.categoryName" ng-maxlength="20" />
							</td>
							<td>
								<select class="input-form-select" ng-model="form.gender" required>
									<option value="mixte" selected>mixte</option>
								    <option value="homme">homme</option>
								    <option value="femme">femme</option>
								 </select>
							</td>
							<td>
								<input class="input-form-small" type="number" ng-model="form.ageLowLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1"/>
							</td>
							<td>
								<input class="input-form-small" type="number" ng-model="form.ageHighLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1" />
							</td>
							<td>
								<input class="input-form-med" type="number" ng-model="form.price"  min="1" max="999" ngMaxlength="3" ngMinlength="1" />
							</td>
							<td class="hidden-xs">
								<div class="btn btn-success label" ng-click="addPrice(prestation._id, form); hiddenForm=true"><i class="fa icon-tab fa-plus"></i></div>
								<div class="btn btn-danger label" ng-click="hiddenForm=true"><i class="fa icon-tab fa-times"></i></div>
							</td>
						</tr>
					</tbody>
				</table> 
				<div class="btn btn-success btn-sm pull-right hidden-xs" ng-click="hiddenForm = false" ng-show="hiddenForm === true"><i class="fa icon-tab fa-plus"></i> Ajouter un nouveau prix</div>
			</div>
		</div>
	</div>
</div>